{
  "hash": "59e1892307dc89e7ddba4f72e8fe26ff",
  "result": {
    "markdown": "---\ntitle: \"Untitled\"\nformat: html\n---\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom read_fire_points import CNFDBFirePointReader\nfrom pathlib import Path\nimport geopandas as gpd\nimport pandas as pd\nimport numpy as np\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/henzhwang/miniconda3/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.26.4\n  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n```\n:::\n:::\n\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nshp_path = '/Users/henzhwang/Desktop/STA4101/Data/CNFDB/Fire Points/NFDB_point/NFDB_point_20250519.shp'\nfp_gdf = gpd.read_file(shp_path)\n```\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# Filter YEAR first (2000–2024)\ngdf_filtered = fp_gdf[fp_gdf[\"YEAR\"].between(2000, 2024)]\n\n# Filter SRC_AGENCY to only BC and AB\ngdf_filtered = gdf_filtered[gdf_filtered[\"SRC_AGENCY\"].isin([\"BC\", \"AB\"])]\n\n# View result\ngdf_filtered\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>NFDBFIREID</th>\n      <th>SRC_AGENCY</th>\n      <th>NAT_PARK</th>\n      <th>FIRE_ID</th>\n      <th>FIRENAME</th>\n      <th>LATITUDE</th>\n      <th>LONGITUDE</th>\n      <th>YEAR</th>\n      <th>MONTH</th>\n      <th>DAY</th>\n      <th>...</th>\n      <th>RESPONSE</th>\n      <th>PROTZONE</th>\n      <th>PRESCRIBED</th>\n      <th>MORE_INFO</th>\n      <th>CFS_NOTE1</th>\n      <th>CFS_NOTE2</th>\n      <th>ACQ_DATE</th>\n      <th>layer</th>\n      <th>omit</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>AB-2024-CWF-001-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>CWF-001-2024</td>\n      <td>None</td>\n      <td>50.066333</td>\n      <td>-114.154883</td>\n      <td>2024</td>\n      <td>1</td>\n      <td>2</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Calgary Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1345400.786 322485.621 0)</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>AB-2024-HWF-001-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>HWF-001-2024</td>\n      <td>None</td>\n      <td>57.912833</td>\n      <td>-116.334050</td>\n      <td>2024</td>\n      <td>1</td>\n      <td>5</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>High Level Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1210041.546 1182823.657 0)</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>AB-2024-SWF-001-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>SWF-001-2024</td>\n      <td>None</td>\n      <td>56.575550</td>\n      <td>-115.216533</td>\n      <td>2024</td>\n      <td>1</td>\n      <td>17</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Slave Lake Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1194304.684 1023994.495 0)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>AB-2024-LWF-001-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>LWF-001-2024</td>\n      <td>None</td>\n      <td>55.957361</td>\n      <td>-110.709667</td>\n      <td>2024</td>\n      <td>1</td>\n      <td>9</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Lac La Biche Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-950764.968 883261.867 0)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>AB-2024-LWF-002-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>LWF-002-2024</td>\n      <td>None</td>\n      <td>55.957361</td>\n      <td>-110.709667</td>\n      <td>2024</td>\n      <td>1</td>\n      <td>9</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Lac La Biche Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-950764.968 883261.867 0)</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>442398</th>\n      <td>BC-2024-2024-G90777</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90777</td>\n      <td>G90777</td>\n      <td>59.946100</td>\n      <td>-123.888600</td>\n      <td>2024</td>\n      <td>6</td>\n      <td>4</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1516114.145 1548789.258 0)</td>\n    </tr>\n    <tr>\n      <th>442399</th>\n      <td>BC-2024-2024-G90207</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90207</td>\n      <td>Patry Creek</td>\n      <td>59.310300</td>\n      <td>-123.282500</td>\n      <td>2024</td>\n      <td>7</td>\n      <td>16</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1516080.541 1472302.048 0)</td>\n    </tr>\n    <tr>\n      <th>442400</th>\n      <td>BC-2024-2024-G90324</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90324</td>\n      <td>G90324</td>\n      <td>59.313900</td>\n      <td>-121.988500</td>\n      <td>2024</td>\n      <td>7</td>\n      <td>10</td>\n      <td>...</td>\n      <td>MOD</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1450882.688 1442470.922 0)</td>\n    </tr>\n    <tr>\n      <th>442401</th>\n      <td>BC-2024-2024-G90285</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90285</td>\n      <td>G90285</td>\n      <td>59.789200</td>\n      <td>-121.606500</td>\n      <td>2024</td>\n      <td>7</td>\n      <td>10</td>\n      <td>...</td>\n      <td>MOD</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1410645.101 1480874.311 0)</td>\n    </tr>\n    <tr>\n      <th>442402</th>\n      <td>BC-2024-2024-G70972</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G70972</td>\n      <td>G70972</td>\n      <td>56.019200</td>\n      <td>-122.543700</td>\n      <td>2024</td>\n      <td>9</td>\n      <td>30</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1629077.473 1130325.143 0)</td>\n    </tr>\n  </tbody>\n</table>\n<p>76465 rows × 27 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ngdf_filtered[\"YEAR\"].min(), gdf_filtered[\"YEAR\"].max()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n(2000, 2024)\n```\n:::\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n(\n    gdf_filtered\n    .groupby([\"YEAR\", \"SRC_AGENCY\"])\n    .size()\n    .reset_index(name=\"fire_count\")\n    .sort_values([\"YEAR\", \"fire_count\"], ascending=[True, False])\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>YEAR</th>\n      <th>SRC_AGENCY</th>\n      <th>fire_count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>2000</td>\n      <td>BC</td>\n      <td>1526</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>2000</td>\n      <td>AB</td>\n      <td>783</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2001</td>\n      <td>BC</td>\n      <td>1291</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2001</td>\n      <td>AB</td>\n      <td>974</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>2002</td>\n      <td>BC</td>\n      <td>1772</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2002</td>\n      <td>AB</td>\n      <td>1445</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2003</td>\n      <td>BC</td>\n      <td>2457</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>2003</td>\n      <td>AB</td>\n      <td>1191</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>2004</td>\n      <td>BC</td>\n      <td>2405</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2004</td>\n      <td>AB</td>\n      <td>1611</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2005</td>\n      <td>AB</td>\n      <td>1374</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2005</td>\n      <td>BC</td>\n      <td>994</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2006</td>\n      <td>BC</td>\n      <td>2560</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2006</td>\n      <td>AB</td>\n      <td>2027</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2007</td>\n      <td>BC</td>\n      <td>1607</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2007</td>\n      <td>AB</td>\n      <td>1337</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2008</td>\n      <td>BC</td>\n      <td>2025</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2008</td>\n      <td>AB</td>\n      <td>1722</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2009</td>\n      <td>BC</td>\n      <td>3049</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2009</td>\n      <td>AB</td>\n      <td>1673</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2010</td>\n      <td>AB</td>\n      <td>1892</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2010</td>\n      <td>BC</td>\n      <td>1689</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2011</td>\n      <td>AB</td>\n      <td>1173</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2011</td>\n      <td>BC</td>\n      <td>646</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2012</td>\n      <td>BC</td>\n      <td>1640</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2012</td>\n      <td>AB</td>\n      <td>1605</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2013</td>\n      <td>BC</td>\n      <td>1867</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2013</td>\n      <td>AB</td>\n      <td>1218</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2014</td>\n      <td>BC</td>\n      <td>1469</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2014</td>\n      <td>AB</td>\n      <td>1451</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>2015</td>\n      <td>BC</td>\n      <td>1863</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>2015</td>\n      <td>AB</td>\n      <td>1856</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>2016</td>\n      <td>AB</td>\n      <td>1436</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>2016</td>\n      <td>BC</td>\n      <td>1068</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>2017</td>\n      <td>BC</td>\n      <td>1349</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>2017</td>\n      <td>AB</td>\n      <td>1244</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>2018</td>\n      <td>BC</td>\n      <td>2089</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>2018</td>\n      <td>AB</td>\n      <td>1299</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>2019</td>\n      <td>AB</td>\n      <td>1021</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>2019</td>\n      <td>BC</td>\n      <td>834</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>2020</td>\n      <td>AB</td>\n      <td>744</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>2020</td>\n      <td>BC</td>\n      <td>668</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>2021</td>\n      <td>BC</td>\n      <td>1649</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>2021</td>\n      <td>AB</td>\n      <td>1383</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>2022</td>\n      <td>BC</td>\n      <td>1783</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>2022</td>\n      <td>AB</td>\n      <td>1297</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>2023</td>\n      <td>BC</td>\n      <td>2280</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>2023</td>\n      <td>AB</td>\n      <td>1131</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>2024</td>\n      <td>BC</td>\n      <td>1725</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>2024</td>\n      <td>AB</td>\n      <td>1273</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## large file\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nlarge_shp_path = '/Users/henzhwang/Desktop/STA4101/Data/CNFDB/Fire Points/NFDB_point_large_fires/NFDB_point_20250519_large_fires.shp'\nfp_large_gdf = gpd.read_file(large_shp_path)\n```\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n# Filter YEAR first (2000–2024)\ngdf_large_filtered = fp_large_gdf[fp_large_gdf[\"YEAR\"].between(2000, 2024)]\n\n# Filter SRC_AGENCY to only BC and AB\ngdf_large_filtered = gdf_large_filtered[gdf_large_filtered[\"SRC_AGENCY\"].isin([\"BC\", \"AB\"])]\n\n# View result\ngdf_large_filtered\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>NFDBFIREID</th>\n      <th>SRC_AGENCY</th>\n      <th>NAT_PARK</th>\n      <th>FIRE_ID</th>\n      <th>FIRENAME</th>\n      <th>LATITUDE</th>\n      <th>LONGITUDE</th>\n      <th>YEAR</th>\n      <th>MONTH</th>\n      <th>DAY</th>\n      <th>...</th>\n      <th>RESPONSE</th>\n      <th>PROTZONE</th>\n      <th>PRESCRIBED</th>\n      <th>MORE_INFO</th>\n      <th>CFS_NOTE1</th>\n      <th>CFS_NOTE2</th>\n      <th>ACQ_DATE</th>\n      <th>layer</th>\n      <th>omit</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>AB-2024-LIR-001-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>LIR-001-2024</td>\n      <td>None</td>\n      <td>54.326420</td>\n      <td>-110.325217</td>\n      <td>2024</td>\n      <td>4</td>\n      <td>22</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Lac La Biche Forest Area</td>\n      <td>Mutual Aid fire within the provincial boundary</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-970446.17 704655.629 0)</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>AB-2024-PMD-003-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>PMD-003-2024</td>\n      <td>None</td>\n      <td>56.132867</td>\n      <td>-117.486092</td>\n      <td>2024</td>\n      <td>4</td>\n      <td>23</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Peace River Forest Area</td>\n      <td>Mutual Aid fire within the provincial boundary</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1339736.783 1023684.044 0)</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>AB-2024-SWF-004-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>SWF-004-2024</td>\n      <td>None</td>\n      <td>55.209667</td>\n      <td>-116.651167</td>\n      <td>2024</td>\n      <td>2</td>\n      <td>23</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Slave Lake Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1325579.527 911509.463 0)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>AB-2024-HWF-021-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>HWF-021-2024</td>\n      <td>None</td>\n      <td>57.678967</td>\n      <td>-114.095367</td>\n      <td>2024</td>\n      <td>4</td>\n      <td>24</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>High Level Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1094651.426 1118128.277 0)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>AB-2024-MWF-071-2024</td>\n      <td>AB</td>\n      <td>None</td>\n      <td>MWF-071-2024</td>\n      <td>None</td>\n      <td>56.373667</td>\n      <td>-112.009833</td>\n      <td>2024</td>\n      <td>7</td>\n      <td>10</td>\n      <td>...</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>Fort McMurray Forest Area</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-07</td>\n      <td>AB_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1015657.475 947223.216 0)</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>21141</th>\n      <td>BC-2024-2024-G80286</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G80286</td>\n      <td>Snowfall Creek G80286</td>\n      <td>58.111400</td>\n      <td>-120.369400</td>\n      <td>2024</td>\n      <td>5</td>\n      <td>11</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1419319.481 1286392.394 0)</td>\n    </tr>\n    <tr>\n      <th>21142</th>\n      <td>BC-2024-2024-G90228</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90228</td>\n      <td>Nogah Creek</td>\n      <td>58.794000</td>\n      <td>-121.626900</td>\n      <td>2024</td>\n      <td>6</td>\n      <td>28</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1455510.039 1382774.988 0)</td>\n    </tr>\n    <tr>\n      <th>21143</th>\n      <td>BC-2024-2024-G90399</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90399</td>\n      <td>G90399</td>\n      <td>59.405700</td>\n      <td>-120.681500</td>\n      <td>2024</td>\n      <td>7</td>\n      <td>6</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1380672.778 1422492.388 0)</td>\n    </tr>\n    <tr>\n      <th>21144</th>\n      <td>BC-2024-2024-G90777</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90777</td>\n      <td>G90777</td>\n      <td>59.946100</td>\n      <td>-123.888600</td>\n      <td>2024</td>\n      <td>6</td>\n      <td>4</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1516114.145 1548789.258 0)</td>\n    </tr>\n    <tr>\n      <th>21145</th>\n      <td>BC-2024-2024-G90207</td>\n      <td>BC</td>\n      <td>None</td>\n      <td>2024-G90207</td>\n      <td>Patry Creek</td>\n      <td>59.310300</td>\n      <td>-123.282500</td>\n      <td>2024</td>\n      <td>7</td>\n      <td>16</td>\n      <td>...</td>\n      <td>FUL</td>\n      <td>None</td>\n      <td>None</td>\n      <td>None</td>\n      <td>NOTE overwinter fire, rep area burned in 2024</td>\n      <td>None</td>\n      <td>2025-04-08</td>\n      <td>BC_NFDB_2024</td>\n      <td>None</td>\n      <td>POINT Z (-1516080.541 1472302.048 0)</td>\n    </tr>\n  </tbody>\n</table>\n<p>1991 rows × 27 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n(\n    fp_large_gdf[fp_large_gdf[\"YEAR\"].between(2020, 2024)]\n    .groupby([\"SRC_AGENCY\"])\n    .size()\n    .reset_index(name=\"fire_count\")\n    .sort_values(\"fire_count\", ascending=[False])\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>SRC_AGENCY</th>\n      <th>fire_count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>BC</td>\n      <td>506</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>SK</td>\n      <td>414</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>NT</td>\n      <td>367</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>MB</td>\n      <td>285</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>YT</td>\n      <td>281</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>QC</td>\n      <td>278</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>AB</td>\n      <td>190</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>ON</td>\n      <td>175</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>PC</td>\n      <td>72</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NL</td>\n      <td>28</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>NS</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>NB</td>\n      <td>2</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\nfp_large_gdf.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n(21146, 27)\n```\n:::\n:::\n\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\ncolumns_equal = list(fp_gdf.columns) == list(fp_large_gdf.columns)\nprint(f\"\\n方法1 - 列名列表是否完全相同: {columns_equal}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n方法1 - 列名列表是否完全相同: True\n```\n:::\n:::\n\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\n# 基于NFDBFIREID添加Large_Fire列\nlarge_ids = set(gdf_large_filtered['NFDBFIREID'].dropna())\ngdf_filtered['Large_Fire'] = gdf_filtered['NFDBFIREID'].apply(lambda x: 'YES' if x in large_ids else 'NO')\nprint(f\"Large_Fire列已添加: YES={(gdf_filtered['Large_Fire'] == 'YES').sum()}, NO={(gdf_filtered['Large_Fire'] == 'NO').sum()}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLarge_Fire列已添加: YES=1995, NO=74470\n```\n:::\n:::\n\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\n# 检查gdf_filtered中是否有重复的NFDBFIREID\nnfdb_fireid_counts = gdf_filtered['NFDBFIREID'].value_counts()\nduplicate_nfdb_fireids = nfdb_fireid_counts[nfdb_fireid_counts > 1]\n\nprint(f\"NFDBFIREID重复检查:\")\nprint(f\"  唯一NFDBFIREID数量: {gdf_filtered['NFDBFIREID'].nunique()}\")\nprint(f\"  总行数: {len(gdf_filtered)}\")\nprint(f\"  重复的NFDBFIREID数量: {len(duplicate_nfdb_fireids)}\")\nprint(f\"  涉及的总行数: {duplicate_nfdb_fireids.sum()}\")\n\nif len(duplicate_nfdb_fireids) > 0:\n    print(f\"\\n前10个重复最多的NFDBFIREID:\")\n    for nfdb_fireid, count in duplicate_nfdb_fireids.head(10).items():\n        print(f\"  NFDBFIREID: {nfdb_fireid}, 出现次数: {count}\")\n    \n    # 显示一个重复NFDBFIREID的示例记录\n    example_nfdb_fireid = duplicate_nfdb_fireids.index[0]\n    print(f\"\\n示例 - NFDBFIREID '{example_nfdb_fireid}' 的重复记录:\")\n    example_records = gdf_filtered[gdf_filtered['NFDBFIREID'] == example_nfdb_fireid]\n    print(example_records[['YEAR', 'SRC_AGENCY', 'LATITUDE', 'LONGITUDE', 'SIZE_HA']].head())\nelse:\n    print(f\"\\n没有重复的NFDBFIREID\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNFDBFIREID重复检查:\n  唯一NFDBFIREID数量: 76183\n  总行数: 76465\n  重复的NFDBFIREID数量: 282\n  涉及的总行数: 564\n\n前10个重复最多的NFDBFIREID:\n  NFDBFIREID: AB-2016-CWF224, 出现次数: 2\n  NFDBFIREID: AB-2006-EWF093, 出现次数: 2\n  NFDBFIREID: AB-2005-CWF077, 出现次数: 2\n  NFDBFIREID: AB-2005-CWF079, 出现次数: 2\n  NFDBFIREID: AB-2005-CWF080, 出现次数: 2\n  NFDBFIREID: AB-2002-LWF111, 出现次数: 2\n  NFDBFIREID: AB-2002-LWF112, 出现次数: 2\n  NFDBFIREID: AB-2009-EWF101, 出现次数: 2\n  NFDBFIREID: AB-2007-HWF166, 出现次数: 2\n  NFDBFIREID: AB-2007-HWF168, 出现次数: 2\n\n示例 - NFDBFIREID 'AB-2016-CWF224' 的重复记录:\n        YEAR SRC_AGENCY   LATITUDE   LONGITUDE  SIZE_HA\n220581  2016         AB  51.269433 -115.021967     0.01\n220651  2016         AB  50.831550 -114.614050     0.01\n```\n:::\n:::\n\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\n# 检查重复的NFDBFIREID数据是否完全重合\nprint(f\"\\n\" + \"=\" * 80)\nprint(\"检查重复的NFDBFIREID数据是否完全重合\")\nprint(\"=\" * 80)\n\nif len(duplicate_nfdb_fireids) > 0:\n    # 获取所有列（排除geometry列，因为比较复杂）\n    columns_to_compare = [col for col in gdf_filtered.columns \n                         if col != 'geometry' and col != 'NFDBFIREID']\n    \n    print(f\"比较的列数: {len(columns_to_compare)}\")\n    print(f\"比较的列: {columns_to_compare[:10]}...\")  # 只显示前10个列\n    \n    # 分析重复行是否完全相同\n    identical_count = 0\n    different_count = 0\n    different_details = []\n    \n    # 检查前20个重复的NFDBFIREID\n    for nfdb_fireid in duplicate_nfdb_fireids.head(20).index:\n        duplicate_rows = gdf_filtered[gdf_filtered['NFDBFIREID'] == nfdb_fireid]\n        \n        if len(duplicate_rows) > 1:\n            # 检查所有行是否完全相同\n            first_row = duplicate_rows.iloc[0][columns_to_compare]\n            all_identical = True\n            differences = []\n            \n            for i in range(1, len(duplicate_rows)):\n                current_row = duplicate_rows.iloc[i][columns_to_compare]\n                \n                # 比较两行是否相同\n                if not first_row.equals(current_row):\n                    all_identical = False\n                    \n                    # 找出不同的列\n                    diff_cols = []\n                    for col in columns_to_compare:\n                        val1 = first_row[col]\n                        val2 = current_row[col]\n                        \n                        # 处理NaN值\n                        if pd.isna(val1) and pd.isna(val2):\n                            continue\n                        elif pd.isna(val1) != pd.isna(val2):\n                            diff_cols.append(col)\n                        elif val1 != val2:\n                            diff_cols.append(col)\n                    \n                    differences.append({\n                        'row_index': duplicate_rows.index[i],\n                        'different_columns': diff_cols,\n                        'different_count': len(diff_cols)\n                    })\n            \n            if all_identical:\n                identical_count += 1\n            else:\n                different_count += 1\n                different_details.append({\n                    'nfdb_fireid': nfdb_fireid,\n                    'row_count': len(duplicate_rows),\n                    'differences': differences\n                })\n    \n    print(f\"\\n重复行完全重合检查结果:\")\n    print(f\"  完全相同的重复NFDBFIREID数量: {identical_count}\")\n    print(f\"  不完全相同的重复NFDBFIREID数量: {different_count}\")\n    \n    if different_count > 0:\n        print(f\"\\n不完全相同的重复NFDBFIREID示例（前5个）:\")\n        for i, detail in enumerate(different_details[:5]):\n            print(f\"\\n  NFDBFIREID: {detail['nfdb_fireid']}\")\n            print(f\"    重复行数: {detail['row_count']}\")\n            print(f\"    差异详情:\")\n            \n            for diff in detail['differences']:\n                print(f\"      行 {diff['row_index']}: {diff['different_count']} 个列不同\")\n                \n                # 显示具体不同的列（最多显示5个）\n                if diff['different_columns']:\n                    print(f\"        不同的列: {diff['different_columns'][:5]}\")\n                    if len(diff['different_columns']) > 5:\n                        print(f\"        ... 还有 {len(diff['different_columns']) - 5} 个列不同\")\n        \n        # 显示一个具体示例的详细比较\n        if len(different_details) > 0:\n            print(f\"\\n\" + \"-\" * 60)\n            print(\"详细比较示例（第一个不完全相同的NFDBFIREID）:\")\n            print(\"-\" * 60)\n            \n            example_detail = different_details[0]\n            example_nfdb_fireid = example_detail['nfdb_fireid']\n            example_rows = gdf_filtered[gdf_filtered['NFDBFIREID'] == example_nfdb_fireid]\n            \n            print(f\"\\nNFDBFIREID: {example_nfdb_fireid}\")\n            print(f\"行数: {len(example_rows)}\")\n            \n            # 显示关键字段的比较\n            key_fields = ['YEAR', 'SRC_AGENCY', 'LATITUDE', 'LONGITUDE', 'SIZE_HA', 'Large_Fire']\n            available_key_fields = [f for f in key_fields if f in columns_to_compare]\n            \n            print(f\"\\n关键字段比较:\")\n            for field in available_key_fields:\n                values = example_rows[field].tolist()\n                unique_values = set(values)\n                if len(unique_values) > 1:\n                    print(f\"  {field}: {values} (不同)\")\n                else:\n                    print(f\"  {field}: {values[0]} (相同)\")\n            \n            # 显示所有不同的列\n            print(f\"\\n所有不同的列:\")\n            all_different_cols = set()\n            for diff in example_detail['differences']:\n                all_different_cols.update(diff['different_columns'])\n            \n            for col in sorted(list(all_different_cols))[:20]:  # 只显示前20个不同的列\n                values = example_rows[col].tolist()\n                unique_values = set(values)\n                if len(unique_values) > 1:\n                    print(f\"  {col}: {values}\")\n    \n    else:\n        print(f\"\\n所有重复的NFDBFIREID对应的行都完全相同\")\n        \nelse:\n    print(f\"\\n没有重复的NFDBFIREID，无需检查是否完全重合\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n================================================================================\n检查重复的NFDBFIREID数据是否完全重合\n================================================================================\n比较的列数: 26\n比较的列: ['SRC_AGENCY', 'NAT_PARK', 'FIRE_ID', 'FIRENAME', 'LATITUDE', 'LONGITUDE', 'YEAR', 'MONTH', 'DAY', 'REP_DATE']...\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n重复行完全重合检查结果:\n  完全相同的重复NFDBFIREID数量: 0\n  不完全相同的重复NFDBFIREID数量: 20\n\n不完全相同的重复NFDBFIREID示例（前5个）:\n\n  NFDBFIREID: AB-2016-CWF224\n    重复行数: 2\n    差异详情:\n      行 220651: 6 个列不同\n        不同的列: ['LATITUDE', 'LONGITUDE', 'MONTH', 'DAY', 'REP_DATE']\n        ... 还有 1 个列不同\n\n  NFDBFIREID: AB-2006-EWF093\n    重复行数: 2\n    差异详情:\n      行 232869: 10 个列不同\n        不同的列: ['LATITUDE', 'LONGITUDE', 'MONTH', 'DAY', 'REP_DATE']\n        ... 还有 5 个列不同\n\n  NFDBFIREID: AB-2005-CWF077\n    重复行数: 2\n    差异详情:\n      行 233196: 7 个列不同\n        不同的列: ['LATITUDE', 'LONGITUDE', 'MONTH', 'DAY', 'REP_DATE']\n        ... 还有 2 个列不同\n\n  NFDBFIREID: AB-2005-CWF079\n    重复行数: 2\n    差异详情:\n      行 233411: 8 个列不同\n        不同的列: ['LATITUDE', 'LONGITUDE', 'MONTH', 'DAY', 'REP_DATE']\n        ... 还有 3 个列不同\n\n  NFDBFIREID: AB-2005-CWF080\n    重复行数: 2\n    差异详情:\n      行 233247: 8 个列不同\n        不同的列: ['LATITUDE', 'LONGITUDE', 'MONTH', 'DAY', 'REP_DATE']\n        ... 还有 3 个列不同\n\n------------------------------------------------------------\n详细比较示例（第一个不完全相同的NFDBFIREID）:\n------------------------------------------------------------\n\nNFDBFIREID: AB-2016-CWF224\n行数: 2\n\n关键字段比较:\n  YEAR: 2016 (相同)\n  SRC_AGENCY: AB (相同)\n  LATITUDE: [51.269433, 50.83155] (不同)\n  LONGITUDE: [-115.021967, -114.61405] (不同)\n  SIZE_HA: 0.01 (相同)\n  Large_Fire: NO (相同)\n\n所有不同的列:\n  DAY: [26, 5]\n  LATITUDE: [51.269433, 50.83155]\n  LONGITUDE: [-115.021967, -114.61405]\n  MONTH: [3, 11]\n  OUT_DATE: [Timestamp('2016-03-26 00:00:00'), Timestamp('2016-11-06 00:00:00')]\n  REP_DATE: [Timestamp('2016-03-26 00:00:00'), Timestamp('2016-11-05 00:00:00')]\n```\n:::\n:::\n\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\n# ============================================================================\n# 对比每一条相同NFDBFIREID的SIZE_HA是否相同\n# ============================================================================\nprint(f\"\\n\" + \"=\" * 80)\nprint(\"对比每一条相同NFDBFIREID的SIZE_HA是否相同\")\nprint(\"=\" * 80)\n\nif len(duplicate_nfdb_fireids) > 0:\n    print(f\"\\n分析重复的NFDBFIREID的SIZE_HA一致性:\")\n    \n    # 统计SIZE_HA是否相同\n    same_size_count = 0\n    different_size_count = 0\n    size_differences = []\n    \n    for nfdb_fireid in duplicate_nfdb_fireids.index:\n        duplicate_rows = gdf_filtered[gdf_filtered['NFDBFIREID'] == nfdb_fireid]\n        \n        if len(duplicate_rows) > 1:\n            # 获取所有SIZE_HA值\n            size_values = duplicate_rows['SIZE_HA'].tolist()\n            \n            # 检查所有SIZE_HA值是否相同\n            unique_sizes = set()\n            for size in size_values:\n                # 处理NaN值\n                if pd.isna(size):\n                    unique_sizes.add('NaN')\n                else:\n                    unique_sizes.add(round(size, 6))  # 使用6位小数精度进行比较\n            \n            if len(unique_sizes) == 1:\n                same_size_count += 1\n            else:\n                different_size_count += 1\n                size_differences.append({\n                    'nfdb_fireid': nfdb_fireid,\n                    'row_count': len(duplicate_rows),\n                    'size_values': size_values,\n                    'unique_sizes': list(unique_sizes)\n                })\n    \n    print(f\"\\nSIZE_HA一致性分析结果:\")\n    print(f\"  重复的NFDBFIREID总数: {len(duplicate_nfdb_fireids)}\")\n    print(f\"  SIZE_HA相同的NFDBFIREID数量: {same_size_count}\")\n    print(f\"  SIZE_HA不同的NFDBFIREID数量: {different_size_count}\")\n    \n    if same_size_count > 0:\n        print(f\"  SIZE_HA相同的比例: {same_size_count/len(duplicate_nfdb_fireids)*100:.1f}%\")\n    \n    if different_size_count > 0:\n        print(f\"\\nSIZE_HA不同的NFDBFIREID示例（前10个）:\")\n        for i, diff in enumerate(size_differences[:10]):\n            print(f\"\\n  {i+1}. NFDBFIREID: {diff['nfdb_fireid']}\")\n            print(f\"     重复行数: {diff['row_count']}\")\n            print(f\"     SIZE_HA值: {diff['size_values']}\")\n            print(f\"     唯一SIZE_HA值: {diff['unique_sizes']}\")\n            \n            # 显示这些记录的详细信息\n            diff_rows = gdf_filtered[gdf_filtered['NFDBFIREID'] == diff['nfdb_fireid']]\n            print(f\"     记录详情:\")\n            for idx, row in diff_rows.iterrows():\n                print(f\"       行 {idx}: YEAR={row['YEAR']}, SRC_AGENCY={row['SRC_AGENCY']}, \"\n                      f\"LAT={row['LATITUDE']:.4f}, LON={row['LONGITUDE']:.4f}, \"\n                      f\"SIZE_HA={row['SIZE_HA']}\")\n        \n        # 分析SIZE_HA差异的统计信息\n        print(f\"\\n\" + \"-\" * 60)\n        print(\"SIZE_HA差异统计分析:\")\n        print(\"-\" * 60)\n        \n        if len(size_differences) > 0:\n            # 计算差异大小\n            size_diffs = []\n            for diff in size_differences:\n                if len(diff['unique_sizes']) > 1:\n                    # 过滤掉NaN值\n                    numeric_sizes = [s for s in diff['unique_sizes'] if s != 'NaN' and isinstance(s, (int, float))]\n                    if len(numeric_sizes) > 1:\n                        max_size = max(numeric_sizes)\n                        min_size = min(numeric_sizes)\n                        if min_size > 0:\n                            ratio = max_size / min_size\n                            size_diffs.append({\n                                'nfdb_fireid': diff['nfdb_fireid'],\n                                'min_size': min_size,\n                                'max_size': max_size,\n                                'ratio': ratio,\n                                'difference': max_size - min_size\n                            })\n            \n            if size_diffs:\n                # 按差异大小排序\n                size_diffs_sorted = sorted(size_diffs, key=lambda x: x['ratio'], reverse=True)\n                \n                print(f\"\\nSIZE_HA差异最大的NFDBFIREID（按比例）:\")\n                for i, diff_info in enumerate(size_diffs_sorted[:5]):\n                    print(f\"  {i+1}. NFDBFIREID: {diff_info['nfdb_fireid']}\")\n                    print(f\"      最小SIZE_HA: {diff_info['min_size']:.4f} ha\")\n                    print(f\"      最大SIZE_HA: {diff_info['max_size']:.4f} ha\")\n                    print(f\"      比例: {diff_info['ratio']:.2f}倍\")\n                    print(f\"      绝对差异: {diff_info['difference']:.4f} ha\")\n                \n                # 计算统计信息\n                ratios = [d['ratio'] for d in size_diffs]\n                differences = [d['difference'] for d in size_diffs]\n                \n                print(f\"\\nSIZE_HA差异统计摘要:\")\n                print(f\"  平均比例: {np.mean(ratios):.2f}倍\")\n                print(f\"  中位数比例: {np.median(ratios):.2f}倍\")\n                print(f\"  最大比例: {np.max(ratios):.2f}倍\")\n                print(f\"  最小比例: {np.min(ratios):.2f}倍\")\n                print(f\"  平均绝对差异: {np.mean(differences):.2f} ha\")\n                print(f\"  最大绝对差异: {np.max(differences):.2f} ha\")\n    \n    # 检查SIZE_HA为0或NaN的情况\n    print(f\"\\n\" + \"-\" * 60)\n    print(\"检查SIZE_HA特殊值情况:\")\n    print(\"-\" * 60)\n    \n    zero_size_count = 0\n    nan_size_count = 0\n    zero_or_nan_details = []\n    \n    for nfdb_fireid in duplicate_nfdb_fireids.index:\n        duplicate_rows = gdf_filtered[gdf_filtered['NFDBFIREID'] == nfdb_fireid]\n        size_values = duplicate_rows['SIZE_HA'].tolist()\n        \n        has_zero = any(size == 0 for size in size_values if not pd.isna(size))\n        has_nan = any(pd.isna(size) for size in size_values)\n        \n        if has_zero or has_nan:\n            zero_or_nan_details.append({\n                'nfdb_fireid': nfdb_fireid,\n                'has_zero': has_zero,\n                'has_nan': has_nan,\n                'size_values': size_values\n            })\n            \n            if has_zero:\n                zero_size_count += 1\n            if has_nan:\n                nan_size_count += 1\n    \n    print(f\"  包含SIZE_HA=0的重复NFDBFIREID数量: {zero_size_count}\")\n    print(f\"  包含SIZE_HA=NaN的重复NFDBFIREID数量: {nan_size_count}\")\n    \n    if zero_or_nan_details:\n        print(f\"\\n包含特殊SIZE_HA值的NFDBFIREID示例（前5个）:\")\n        for i, detail in enumerate(zero_or_nan_details[:5]):\n            print(f\"  {i+1}. NFDBFIREID: {detail['nfdb_fireid']}\")\n            print(f\"      SIZE_HA值: {detail['size_values']}\")\n            if detail['has_zero']:\n                print(f\"      包含0值\")\n            if detail['has_nan']:\n                print(f\"      包含NaN值\")\n    \nelse:\n    print(f\"\\n没有重复的NFDBFIREID，无需检查SIZE_HA一致性\")\n\nprint(f\"\\n\" + \"=\" * 80)\nprint(\"SIZE_HA一致性分析完成\")\nprint(\"=\" * 80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n================================================================================\n对比每一条相同NFDBFIREID的SIZE_HA是否相同\n================================================================================\n\n分析重复的NFDBFIREID的SIZE_HA一致性:\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nSIZE_HA一致性分析结果:\n  重复的NFDBFIREID总数: 282\n  SIZE_HA相同的NFDBFIREID数量: 90\n  SIZE_HA不同的NFDBFIREID数量: 192\n  SIZE_HA相同的比例: 31.9%\n\nSIZE_HA不同的NFDBFIREID示例（前10个）:\n\n  1. NFDBFIREID: AB-2006-EWF093\n     重复行数: 2\n     SIZE_HA值: [0.3, 0.01]\n     唯一SIZE_HA值: [0.3, 0.01]\n     记录详情:\n       行 205162: YEAR=2006, SRC_AGENCY=AB, LAT=53.3613, LON=-117.5259, SIZE_HA=0.3\n       行 232869: YEAR=2006, SRC_AGENCY=AB, LAT=53.3055, LON=-116.8935, SIZE_HA=0.01\n\n  2. NFDBFIREID: AB-2005-CWF079\n     重复行数: 2\n     SIZE_HA值: [0.01, 0.75]\n     唯一SIZE_HA值: [0.75, 0.01]\n     记录详情:\n       行 230982: YEAR=2005, SRC_AGENCY=AB, LAT=50.8526, LON=-114.6178, SIZE_HA=0.01\n       行 233411: YEAR=2005, SRC_AGENCY=AB, LAT=50.2954, LON=-114.6976, SIZE_HA=0.75\n\n  3. NFDBFIREID: AB-2005-CWF080\n     重复行数: 2\n     SIZE_HA值: [0.01, 5.75]\n     唯一SIZE_HA值: [0.01, 5.75]\n     记录详情:\n       行 230983: YEAR=2005, SRC_AGENCY=AB, LAT=50.8527, LON=-114.6174, SIZE_HA=0.01\n       行 233247: YEAR=2005, SRC_AGENCY=AB, LAT=51.1184, LON=-114.9074, SIZE_HA=5.75\n\n  4. NFDBFIREID: AB-2002-LWF111\n     重复行数: 2\n     SIZE_HA值: [0.01, 0.1]\n     唯一SIZE_HA值: [0.1, 0.01]\n     记录详情:\n       行 225034: YEAR=2002, SRC_AGENCY=AB, LAT=54.7330, LON=-111.5924, SIZE_HA=0.01\n       行 229393: YEAR=2002, SRC_AGENCY=AB, LAT=54.9329, LON=-112.1465, SIZE_HA=0.1\n\n  5. NFDBFIREID: AB-2002-LWF112\n     重复行数: 2\n     SIZE_HA值: [0.01, 0.3]\n     唯一SIZE_HA值: [0.3, 0.01]\n     记录详情:\n       行 225035: YEAR=2002, SRC_AGENCY=AB, LAT=54.6894, LON=-110.9878, SIZE_HA=0.01\n       行 228911: YEAR=2002, SRC_AGENCY=AB, LAT=55.3262, LON=-110.2291, SIZE_HA=0.3\n\n  6. NFDBFIREID: AB-2009-EWF101\n     重复行数: 2\n     SIZE_HA值: [6.01, 0.01]\n     唯一SIZE_HA值: [0.01, 6.01]\n     记录详情:\n       行 204580: YEAR=2009, SRC_AGENCY=AB, LAT=53.7337, LON=-117.9586, SIZE_HA=6.01\n       行 209959: YEAR=2009, SRC_AGENCY=AB, LAT=53.2916, LON=-117.2800, SIZE_HA=0.01\n\n  7. NFDBFIREID: AB-2007-HWF166\n     重复行数: 2\n     SIZE_HA值: [0.9, 0.5]\n     唯一SIZE_HA值: [0.9, 0.5]\n     记录详情:\n       行 201347: YEAR=2007, SRC_AGENCY=AB, LAT=58.8066, LON=-119.5327, SIZE_HA=0.9\n       行 201672: YEAR=2007, SRC_AGENCY=AB, LAT=58.5038, LON=-115.1718, SIZE_HA=0.5\n\n  8. NFDBFIREID: AB-2007-HWF168\n     重复行数: 2\n     SIZE_HA值: [0.3, 0.28]\n     唯一SIZE_HA值: [0.3, 0.28]\n     记录详情:\n       行 201349: YEAR=2007, SRC_AGENCY=AB, LAT=59.4806, LON=-116.7811, SIZE_HA=0.3\n       行 201906: YEAR=2007, SRC_AGENCY=AB, LAT=58.2285, LON=-114.3251, SIZE_HA=0.28\n\n  9. NFDBFIREID: AB-2012-GWF055\n     重复行数: 2\n     SIZE_HA值: [0.02, 0.15]\n     唯一SIZE_HA值: [0.02, 0.15]\n     记录详情:\n       行 208902: YEAR=2012, SRC_AGENCY=AB, LAT=54.8061, LON=-119.6337, SIZE_HA=0.02\n       行 214503: YEAR=2012, SRC_AGENCY=AB, LAT=54.9971, LON=-118.5807, SIZE_HA=0.15\n\n  10. NFDBFIREID: AB-2018-MWF094\n     重复行数: 2\n     SIZE_HA值: [1.08, 0.01]\n     唯一SIZE_HA值: [1.08, 0.01]\n     记录详情:\n       行 217603: YEAR=2018, SRC_AGENCY=AB, LAT=57.1814, LON=-110.1670, SIZE_HA=1.08\n       行 217869: YEAR=2018, SRC_AGENCY=AB, LAT=56.9042, LON=-111.5436, SIZE_HA=0.01\n\n------------------------------------------------------------\nSIZE_HA差异统计分析:\n------------------------------------------------------------\n\nSIZE_HA差异最大的NFDBFIREID（按比例）:\n  1. NFDBFIREID: AB-2006-PWF095\n      最小SIZE_HA: 0.0100 ha\n      最大SIZE_HA: 5900.0000 ha\n      比例: 590000.00倍\n      绝对差异: 5899.9900 ha\n  2. NFDBFIREID: AB-2006-EWF109\n      最小SIZE_HA: 0.0500 ha\n      最大SIZE_HA: 14554.3000 ha\n      比例: 291086.00倍\n      绝对差异: 14554.2500 ha\n  3. NFDBFIREID: AB-2015-PWF131\n      最小SIZE_HA: 0.0100 ha\n      最大SIZE_HA: 2872.8000 ha\n      比例: 287280.00倍\n      绝对差异: 2872.7900 ha\n  4. NFDBFIREID: AB-2012-CWF240\n      最小SIZE_HA: 0.0100 ha\n      最大SIZE_HA: 160.0000 ha\n      比例: 16000.00倍\n      绝对差异: 159.9900 ha\n  5. NFDBFIREID: AB-2015-PWF129\n      最小SIZE_HA: 0.1000 ha\n      最大SIZE_HA: 419.5000 ha\n      比例: 4195.00倍\n      绝对差异: 419.4000 ha\n\nSIZE_HA差异统计摘要:\n  平均比例: 6315.11倍\n  中位数比例: 20.00倍\n  最大比例: 590000.00倍\n  最小比例: 1.07倍\n  平均绝对差异: 126.93 ha\n  最大绝对差异: 14554.25 ha\n\n------------------------------------------------------------\n检查SIZE_HA特殊值情况:\n------------------------------------------------------------\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n  包含SIZE_HA=0的重复NFDBFIREID数量: 0\n  包含SIZE_HA=NaN的重复NFDBFIREID数量: 0\n\n================================================================================\nSIZE_HA一致性分析完成\n================================================================================\n```\n:::\n:::\n\n\n",
    "supporting": [
      "FP_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}